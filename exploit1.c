#include <stdio.h>
#include <fcntl.h>
#include <sys/wait.h>
#include <sys/stat.h>
#include <unistd.h>

int main(int argc, char* argv[])
{
    int fd = open("/proc/self/exe", O_RDONLY);
    printf("Phase 1: FD=%d\n", fd);

    char fdpath[255];
    sprintf(fdpath, "/proc/self/fd/%d", fd);

    char *args[] = {fdpath, NULL};

    execve("./exploit2", args, NULL);

    return 0;
}
